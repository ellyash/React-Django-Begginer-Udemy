(this["webpackJsonpmovie-rater"]=this["webpackJsonpmovie-rater"]||[]).push([[0],{36:function(e,t,n){},37:function(e,t,n){},50:function(e,t,n){"use strict";n.r(t);var c=n(0),o=n.n(c),i=n(26),a=n.n(i),r=(n(36),n(18)),s=n(3),u=(n(37),n(9)),l=n(10),j=n(27),d=n(28),h=function(){function e(){Object(j.a)(this,e)}return Object(d.a)(e,null,[{key:"updateMovie",value:function(e,t,n){return fetch("".concat("https://movie-rater-native.herokuapp.com","/api/movies/").concat(e,"/"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(n)},body:JSON.stringify(t)}).then((function(e){return e.json()}))}},{key:"createMovie",value:function(e,t){return fetch("".concat("https://movie-rater-native.herokuapp.com","/api/movies/"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(t)},body:JSON.stringify(e)}).then((function(e){return e.json()}))}},{key:"deleteMovie",value:function(e,t){return fetch("".concat("https://movie-rater-native.herokuapp.com","/api/movies/").concat(e,"/"),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(t)}})}},{key:"loginUser",value:function(e){return fetch("".concat("https://movie-rater-native.herokuapp.com","/auth/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()}))}},{key:"registerUser",value:function(e){return fetch("".concat("https://movie-rater-native.herokuapp.com","/api/users/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()}))}},{key:"getMovies",value:function(e){return fetch("".concat("https://movie-rater-native.herokuapp.com","/api/movies/"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(e)}}).then((function(e){return e.json()}))}}]),e}(),b=n(51),p=n(1);var O=function(e){var t=Object(b.a)(["login-token"]),n=Object(s.a)(t,1)[0],c=function(t){return function(n){e.movieClicked(t)}};return Object(p.jsx)("div",{children:e.movies&&e.movies.map((function(t){return Object(p.jsxs)("div",{className:"movie-item",children:[Object(p.jsx)("h2",{onClick:c(t),children:t.title}),Object(p.jsx)(u.a,{icon:l.a,onClick:function(){return function(t){e.editClicked(t)}(t)}}),Object(p.jsx)(u.a,{icon:l.e,onClick:function(){return function(t){h.deleteMovie(t.id,n["login-token"]).then((function(){return e.removeClicked(t)})).catch((function(e){return console.log(e)}))}(t)}})]},t.id)}))})};var v=function(e){var t=e.movie,n=Object(c.useState)(-1),i=Object(s.a)(n,2),a=i[0],j=i[1],d=Object(b.a)(["login-token"]),h=Object(s.a)(d,1)[0],O=function(e){return function(t){j(e)}},v=function(){fetch("".concat("https://movie-rater-native.herokuapp.com","/api/movies/").concat(t.id,"/"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(h["login-token"])}}).then((function(e){return e.json()})).then((function(t){return e.updateMovie(t)})).catch((function(e){return console.log(e)}))};return Object(p.jsx)(o.a.Fragment,{children:t?Object(p.jsxs)("div",{className:"movie-details",children:[Object(p.jsx)("h1",{children:t&&t.title}),Object(p.jsx)("p",{children:t&&t.description}),Object(p.jsx)("h3",{children:"Community Rating"}),Object(p.jsxs)("div",{className:"rate-container",children:[Object(p.jsx)(u.a,{icon:l.d,className:t.avg_rating>0?"gold":""}),Object(p.jsxs)("span",{className:"avg-rating",children:[" ",t.avg_rating,"/5 "]}),Object(p.jsxs)("span",{className:"no-of-ratings",children:["(",t.no_of_ratings,")"]})]}),Object(p.jsxs)("div",{className:"rate-container",children:[Object(p.jsx)("h3",{children:"Your rating"}),Object(r.a)(Array(5)).map((function(e,n){return Object(p.jsx)(u.a,{icon:l.d,className:a>n-1?"orange":"",onMouseEnter:O(n),onMouseLeave:O(-1),onClick:(c=n,function(e){fetch("".concat("https://movie-rater-native.herokuapp.com","/api/movies/").concat(t.id,"/rate_movie/"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(h["login-token"])},body:JSON.stringify({stars:c+1})}).then((function(){return v()})).catch((function(e){return console.log(e)}))})},n);var c}))]})]}):null})};var f=function(e){var t=Object(c.useState)(""),n=Object(s.a)(t,2),i=n[0],a=n[1],r=Object(c.useState)(""),u=Object(s.a)(r,2),l=u[0],j=u[1],d=Object(b.a)(["login-token"]),O=Object(s.a)(d,1)[0];Object(c.useEffect)((function(){a(e.movie.title),j(e.movie.description)}),[e.movie]);var v=0===i.length||0===l.length;return Object(p.jsx)(o.a.Fragment,{children:e.movie?Object(p.jsxs)("div",{children:[Object(p.jsx)("label",{htmlFor:"title",children:"Title"}),Object(p.jsx)("br",{}),Object(p.jsx)("input",{id:"title",type:"text",placeholder:"Title",value:i,onChange:function(e){return a(e.target.value)}}),Object(p.jsx)("br",{}),Object(p.jsx)("label",{htmlFor:"description",children:"Description"}),Object(p.jsx)("br",{}),Object(p.jsx)("textarea",{id:"description",type:"text",placeholder:"Description",value:l,onChange:function(e){return j(e.target.value)}}),Object(p.jsx)("br",{}),e.movie.id?Object(p.jsx)("button",{onClick:function(){h.updateMovie(e.movie.id,{title:i,description:l},O["login-token"]).then((function(t){return e.updatedMovie(t)})).catch((function(e){return console.log(e)}))},disabled:v,children:"Update Movie"}):Object(p.jsx)("button",{onClick:function(){h.createMovie({title:i,description:l},O["login-token"]).then((function(t){return e.updateNewMovie(t)})).catch((function(e){return console.log(e)}))},disabled:v,children:"Add Movie"})]}):null})},m=n(23),x=n.n(m),g=n(29);var k=function(){var e=Object(c.useState)([]),t=Object(s.a)(e,2),n=t[0],o=t[1],i=Object(c.useState)(null),a=Object(s.a)(i,2),j=a[0],d=a[1],m=Object(c.useState)(null),k=Object(s.a)(m,2),y=k[0],C=k[1],T=Object(b.a)(["login-token"]),S=Object(s.a)(T,3),N=S[0],M=(S[1],S[2]),w=function(){var e=Object(c.useState)([]),t=Object(s.a)(e,2),n=t[0],o=t[1],i=Object(c.useState)(!0),a=Object(s.a)(i,2),r=a[0],u=a[1],l=Object(c.useState)(),j=Object(s.a)(l,2),d=j[0],p=j[1],O=Object(b.a)(["login-token"]),v=Object(s.a)(O,1)[0];return Object(c.useEffect)((function(){function e(){return(e=Object(g.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),p(),e.next=4,h.getMovies(v["login-token"]).catch((function(e){return p(e)}));case 4:t=e.sent,o(t),u(!1);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),[n,r,d]}(),A=Object(s.a)(w,3),E=A[0],F=A[1],P=A[2];Object(c.useEffect)((function(){o(E)}),[E]),Object(c.useEffect)((function(){N["login-token"]||(window.location.href="/")}),[N]);var U=function(e){d(e),C(null)};return F?Object(p.jsx)("h2",{children:"Loading..."}):P?Object(p.jsx)("h2",{children:"Error"}):Object(p.jsxs)("div",{className:"App",children:[Object(p.jsxs)("header",{className:"App-header",children:[Object(p.jsxs)("h1",{children:[Object(p.jsx)(u.a,{icon:l.b})," ",Object(p.jsxs)("span",{children:["M",Object(p.jsx)(u.a,{icon:l.d}),"vie Rater"]})]}),Object(p.jsx)(u.a,{icon:l.c,onClick:function(){M(["login-token"])}})]}),Object(p.jsxs)("div",{className:"layout",children:[Object(p.jsxs)("div",{children:[Object(p.jsx)(O,{movies:n,movieClicked:U,editClicked:function(e){C(e),d(null)},removeClicked:function(e){var t=n.filter((function(t){return t.id!==e.id}));o(t)}}),Object(p.jsx)("button",{onClick:function(){C({title:"",description:""}),d(null)},children:"Add Movie"})]}),Object(p.jsx)(v,{movie:j,updateMovie:U}),y?Object(p.jsx)(f,{movie:y,updatedMovie:function(e){var t=n.map((function(t){return t.id===e.id?(C(null),e):t}));o(t)},updateNewMovie:function(e){var t=[].concat(Object(r.a)(n),[e]);o(t)}}):null]})]})},y=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,53)).then((function(t){var n=t.getCLS,c=t.getFID,o=t.getFCP,i=t.getLCP,a=t.getTTFB;n(e),c(e),o(e),i(e),a(e)}))},C=n(30),T=n(4);var S=function(){var e=Object(c.useState)(""),t=Object(s.a)(e,2),n=t[0],o=t[1],i=Object(c.useState)(""),a=Object(s.a)(i,2),r=a[0],u=a[1],l=Object(c.useState)(!0),j=Object(s.a)(l,2),d=j[0],O=j[1],v=Object(b.a)(["login-token"]),f=Object(s.a)(v,2),m=f[0],x=f[1],g=function(){h.loginUser({username:n,password:r}).then((function(e){return x("login-token",e.token)})).catch((function(e){return console.log(e)}))};Object(c.useEffect)((function(){m["login-token"]&&(window.location.href="/movies")}),[m]);var k=0===n.length||0===r.length;return Object(p.jsxs)("div",{className:"App",children:[Object(p.jsx)("header",{className:"App-header",children:d?Object(p.jsx)("h1",{children:"Login"}):Object(p.jsx)("h1",{children:"Register"})}),Object(p.jsxs)("div",{className:"login-container",children:[Object(p.jsx)("label",{htmlFor:"username",children:"Username"}),Object(p.jsx)("br",{}),Object(p.jsx)("input",{id:"username",type:"text",placeholder:"Username",value:n,onChange:function(e){return o(e.target.value)}}),Object(p.jsx)("br",{}),Object(p.jsx)("label",{htmlFor:"password",children:"Password"}),Object(p.jsx)("br",{}),Object(p.jsx)("input",{id:"password",type:"password",placeholder:"Password",value:r,onChange:function(e){return u(e.target.value)}}),Object(p.jsx)("br",{}),d?Object(p.jsx)("button",{onClick:g,disabled:k,children:"Log In"}):Object(p.jsx)("button",{onClick:function(){h.registerUser({username:n,password:r}).then((function(){return g()})).catch((function(e){return console.log(e)}))},disabled:k,children:"Create account"}),d?Object(p.jsxs)("p",{children:["You don't have an account?",Object(p.jsxs)("span",{onClick:function(){return O(!1)},className:"reg-redirect",children:[" ","Sign Up"]})]}):Object(p.jsxs)("p",{children:["You already have an account?",Object(p.jsxs)("span",{onClick:function(){return O(!0)},className:"reg-redirect",children:[" ","Sign In"]})]})]})]})},N=n(52);function M(){return Object(p.jsx)(o.a.StrictMode,{children:Object(p.jsx)(N.a,{children:Object(p.jsxs)(C.a,{children:[Object(p.jsx)(T.a,{exact:!0,path:"/",component:S}),Object(p.jsx)(T.a,{exact:!0,path:"/movies",component:k})]})})})}a.a.render(Object(p.jsx)(M,{}),document.getElementById("root")),y()}},[[50,1,2]]]);
//# sourceMappingURL=main.13f46e29.chunk.js.map